---
title: statics-comm.stx
hide:
  - toc
---

# `statics-comm.stx`

:simple-github: [pdmosses/metaborg-poosl/org.metaborg.lang.poosl/trans/statics-comm.stx]

[pdmosses/metaborg-poosl/org.metaborg.lang.poosl/trans/statics-comm.stx]: https://github.com/pdmosses/metaborg-poosl/blob/master/org.metaborg.lang.poosl/trans/statics-comm.stx "The source file on GitHub"

<div class="stx"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
</pre></div></td>
<td class="code"><pre><code><span class="keyword">module</span> <a href="../statics.stx/#statics-comm_6_5" id="statics-comm_1_8" title="a definition with a single reference"><span class="token sort_Id">statics-comm</span></a>

<span class="keyword">imports</span>
    <a href="../../src-gen/statix/signatures/Poosl-sig.stx/#signatures/Poosl-sig_1_8" id="signatures/Poosl-sig_4_5" title="a reference to a single-file definition"><span class="token sort_Id">signatures/Poosl-sig</span></a>
    <a href="../../src-gen/statix/signatures/Common-sig.stx/#signatures/Common-sig_1_8" id="signatures/Common-sig_5_5" title="a reference to a single-file definition"><span class="token sort_Id">signatures/Common-sig</span></a>
    <a href="../statics-opt.stx/#statics-opt_1_8" id="statics-opt_6_5" title="a reference to a single-file definition"><span class="token sort_Id">statics-opt</span></a>
    <a href="../statics-names.stx/#statics-names_1_8" id="statics-names_7_5" title="a reference to a single-file definition"><span class="token sort_Id">statics-names</span></a>
    <a href="../statics-expr-stat.stx/#statics-expr-stat_1_8" id="statics-expr-stat_8_5" title="a reference to a single-file definition"><span class="token sort_Id">statics-expr-stat</span></a>
    <a href="../statics-typing.stx/#statics-typing_1_8" id="statics-typing_9_5" title="a reference to a single-file definition"><span class="token sort_Id">statics-typing</span></a>

<span class="keyword">rules</span> <span class="layout">// === Ports and messages =======</span>

    <button class="modal-open" id="okPorts_13_5" title="a definition with multiple references" data-urls="../statics.stx/#okPorts line 51_9, 62_9"><span class="token sort_Id">okPorts</span></button> <span class="keyword">maps</span> <a href="#okPort_14_5" id="okPort_13_18" title="a reference to a single-file definition"><span class="token sort_Id">okPort</span></a><span class="operator">(*,</span> <span class="keyword">list</span><span class="operator">(*))</span>
    <button class="modal-open" id="okPort_14_5" title="a definition with multiple references" data-urls="#okPort line 13_18, 15_5"><span class="token sort_Id">okPort</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#Port_34_5" id="Port_14_22" title="a reference to a single-file definition"><span class="token sort_Id">Port</span></a></span>
    <a href="#okPort_14_5" id="okPort_15_5" title="a reference to a single-file definition"><span class="token sort_Id">okPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_15_45" id="s_15_12" title="a definition with a single reference"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#Port_130_5" id="Port_15_15" title="a reference to a single-file definition"><span class="token sort_Id">Port</span></a><span class="operator">(</span><span class="cons_Var"><a href="#name_15_48" id="name_15_20" title="a definition with a single reference"><span class="token sort_Id">name</span></a></span><span class="operator">,</span> <span class="operator">_)</span></span><span class="operator">)</span> <span class="operator">:-</span> <a href="../statics-names.stx/#declarePort_277_5" id="declarePort_15_33" title="a reference to a single-file definition"><span class="token sort_Id">declarePort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_15_12" id="s_15_45" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#name_15_20" id="name_15_48" title="a reference to a single-file definition"><span class="token sort_Id">name</span></a></span><span class="operator">).</span>

    <a href="../statics.stx/#okMessageSignatures_52_9" id="okMessageSignatures_17_5" title="a definition with a single reference"><span class="token sort_Id">okMessageSignatures</span></a> <span class="keyword">maps</span> <a href="#okMessageSignature_18_5" id="okMessageSignature_17_30" title="a reference to a single-file definition"><span class="token sort_Id">okMessageSignature</span></a><span class="operator">(*,</span> <span class="keyword">list</span><span class="operator">(*))</span>
    <button class="modal-open" id="okMessageSignature_18_5" title="a definition with multiple references" data-urls="#okMessageSignature line 17_30, 19_5, 23_5"><span class="token sort_Id">okMessageSignature</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#MessageSignature_36_5" id="MessageSignature_18_34" title="a reference to a single-file definition"><span class="token sort_Id">MessageSignature</span></a></span>
    <a href="#okMessageSignature_18_5" id="okMessageSignature_19_5" title="a reference to a single-file definition"><span class="token sort_Id">okMessageSignature</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="s_19_24" title="a definition with multiple references" data-urls="#s line 20_20, 21_72, 22_31"><span class="token sort_Id">s</span></button></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#MessageReceiveSignature_132_5" id="MessageReceiveSignature_19_27" title="a reference to a single-file definition"><span class="token sort_Id">MessageReceiveSignature</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="port_19_51" title="a definition with multiple references" data-urls="#port line 20_23, 22_34"><span class="token sort_Id">port</span></button></span><span class="operator">,</span> <span class="cons_Var"><a href="#message_22_40" id="message_19_57" title="a definition with a single reference"><span class="token sort_Id">message</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#parameters_21_75" id="parameters_19_66" title="a definition with a single reference"><span class="token sort_Id">parameters</span></a></span><span class="operator">,</span> <span class="operator">_)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <a href="../statics-names.stx/#typeOfPort_283_5" id="typeOfPort_20_9" title="a reference to a single-file definition"><span class="token sort_Id">typeOfPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_19_24" id="s_20_20" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#port_19_51" id="port_20_23" title="a reference to a single-file definition"><span class="token sort_Id">port</span></a></span><span class="operator">),</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="typesParameters_21_10" title="a definition with multiple references" data-urls="#typesParameters line 21_27, 22_61"><span class="token sort_Id">typesParameters</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#typesParameters_21_10" id="typesParameters_21_27" title="a reference to a single-file definition"><span class="token sort_Id">typesParameters</span></a></span> <span class="operator">==</span> <a href="#okOptMessageParameterList_28_5" id="okOptMessageParameterList_21_46" title="a reference to a single-file definition"><span class="token sort_Id">okOptMessageParameterList</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_19_24" id="s_21_72" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#parameters_19_66" id="parameters_21_75" title="a reference to a single-file definition"><span class="token sort_Id">parameters</span></a></span><span class="operator">),</span>
        <a href="../statics-names.stx/#declareReceiveMessage_216_5" id="declareReceiveMessage_22_9" title="a reference to a single-file definition"><span class="token sort_Id">declareReceiveMessage</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_19_24" id="s_22_31" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#port_19_51" id="port_22_34" title="a reference to a single-file definition"><span class="token sort_Id">port</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#message_19_57" id="message_22_40" title="a reference to a single-file definition"><span class="token sort_Id">message</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../statics-names.stx/#TypeMessage_30_9" id="TypeMessage_22_49" title="a reference to a single-file definition"><span class="token sort_Id">TypeMessage</span></a><span class="operator">(</span><span class="cons_Var"><a href="#typesParameters_21_10" id="typesParameters_22_61" title="a reference to a single-file definition"><span class="token sort_Id">typesParameters</span></a></span><span class="operator">)</span></span><span class="operator">).</span>
    <a href="#okMessageSignature_18_5" id="okMessageSignature_23_5" title="a reference to a single-file definition"><span class="token sort_Id">okMessageSignature</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="s_23_24" title="a definition with multiple references" data-urls="#s line 24_20, 25_72, 26_28"><span class="token sort_Id">s</span></button></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#MessageSendSignature_133_5" id="MessageSendSignature_23_27" title="a reference to a single-file definition"><span class="token sort_Id">MessageSendSignature</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="port_23_48" title="a definition with multiple references" data-urls="#port line 24_23, 26_31"><span class="token sort_Id">port</span></button></span><span class="operator">,</span> <span class="cons_Var"><a href="#message_26_37" id="message_23_54" title="a definition with a single reference"><span class="token sort_Id">message</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#parameters_25_75" id="parameters_23_63" title="a definition with a single reference"><span class="token sort_Id">parameters</span></a></span><span class="operator">,</span> <span class="operator">_)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <a href="../statics-names.stx/#typeOfPort_283_5" id="typeOfPort_24_9" title="a reference to a single-file definition"><span class="token sort_Id">typeOfPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_23_24" id="s_24_20" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#port_23_48" id="port_24_23" title="a reference to a single-file definition"><span class="token sort_Id">port</span></a></span><span class="operator">),</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="typesParameters_25_10" title="a definition with multiple references" data-urls="#typesParameters line 25_27, 26_58"><span class="token sort_Id">typesParameters</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#typesParameters_25_10" id="typesParameters_25_27" title="a reference to a single-file definition"><span class="token sort_Id">typesParameters</span></a></span> <span class="operator">==</span> <a href="#okOptMessageParameterList_28_5" id="okOptMessageParameterList_25_46" title="a reference to a single-file definition"><span class="token sort_Id">okOptMessageParameterList</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_23_24" id="s_25_72" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#parameters_23_63" id="parameters_25_75" title="a reference to a single-file definition"><span class="token sort_Id">parameters</span></a></span><span class="operator">),</span>
        <a href="../statics-names.stx/#declareSendMessage_237_5" id="declareSendMessage_26_9" title="a reference to a single-file definition"><span class="token sort_Id">declareSendMessage</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_23_24" id="s_26_28" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#port_23_48" id="port_26_31" title="a reference to a single-file definition"><span class="token sort_Id">port</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#message_23_54" id="message_26_37" title="a reference to a single-file definition"><span class="token sort_Id">message</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../statics-names.stx/#TypeMessage_30_9" id="TypeMessage_26_46" title="a reference to a single-file definition"><span class="token sort_Id">TypeMessage</span></a><span class="operator">(</span><span class="cons_Var"><a href="#typesParameters_25_10" id="typesParameters_26_58" title="a reference to a single-file definition"><span class="token sort_Id">typesParameters</span></a></span><span class="operator">)</span></span><span class="operator">).</span>

    <button class="modal-open" id="okOptMessageParameterList_28_5" title="a definition with multiple references" data-urls="#okOptMessageParameterList line 21_46, 25_46, 29_5, 30_5"><span class="token sort_Id">okOptMessageParameterList</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#OptMessageParameterList_37_5" id="OptMessageParameterList_28_41" title="a reference to a single-file definition"><span class="token sort_Id">OptMessageParameterList</span></a></span> <span class="operator">-&gt;</span> <span class="keyword">list</span><span class="operator">(</span><span class="cons_SimpleSort"><a href="../statics-names.stx/#TypeDataClass_19_11" id="TypeDataClass_28_73" title="a reference to a single-file definition"><span class="token sort_Id">TypeDataClass</span></a></span><span class="operator">)</span>
    <a href="#okOptMessageParameterList_28_5" id="okOptMessageParameterList_29_5" title="a reference to a single-file definition"><span class="token sort_Id">okOptMessageParameterList</span></a><span class="operator">(</span><span class="cons_Var">s</span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#MessageParameters_134_5" id="MessageParameters_29_34" title="a reference to a single-file definition"><span class="token sort_Id">MessageParameters</span></a><span class="operator">(</span><span class="cons_Var">types</span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">=</span> <a href="../statics-names.stx/#typeOfDataClasses_80_5" id="typeOfDataClasses_29_62" title="a reference to a single-file definition"><span class="token sort_Id">typeOfDataClasses</span></a><span class="operator">(</span><span class="cons_Var"><span id="s_29_80" title="a definition with no references"><span class="token sort_Id">s</span></span></span><span class="operator">,</span> <span class="cons_Var"><span id="types_29_83" title="a definition with no references"><span class="token sort_Id">types</span></span></span><span class="operator">).</span>
    <a href="#okOptMessageParameterList_28_5" id="okOptMessageParameterList_30_5" title="a reference to a single-file definition"><span class="token sort_Id">okOptMessageParameterList</span></a><span class="operator">(</span><span class="cons_Var"><span id="s_30_31" title="a definition with no references"><span class="token sort_Id">s</span></span></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#NoMessageParameters_135_5" id="NoMessageParameters_30_34" title="a reference to a single-file definition"><span class="token sort_Id">NoMessageParameters</span></a><span class="operator">()</span></span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">[].</span>

<span class="keyword">rules</span> <span class="layout">// === Instances and channels =======</span>

    <button class="modal-open" id="okInstances_34_5" title="a definition with multiple references" data-urls="../statics.stx/#okInstances line 63_9, 68_9"><span class="token sort_Id">okInstances</span></button> <span class="keyword">maps</span> <a href="#okInstance_35_5" id="okInstance_34_22" title="a reference to a single-file definition"><span class="token sort_Id">okInstance</span></a><span class="operator">(*,</span> <span class="keyword">list</span><span class="operator">(*))</span>
    <button class="modal-open" id="okInstance_35_5" title="a definition with multiple references" data-urls="#okInstance line 34_22, 36_5"><span class="token sort_Id">okInstance</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#Instance_39_5" id="Instance_35_26" title="a reference to a single-file definition"><span class="token sort_Id">Instance</span></a></span>
    <a href="#okInstance_35_5" id="okInstance_36_5" title="a reference to a single-file definition"><span class="token sort_Id">okInstance</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="s_36_16" title="a definition with multiple references" data-urls="#s line 37_46, 38_25, 39_30"><span class="token sort_Id">s</span></button></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#Instance_139_5" id="Instance_36_19" title="a reference to a single-file definition"><span class="token sort_Id">Instance</span></a><span class="operator">(</span><span class="cons_Var"><span id="annotationList_36_28" title="a definition with no references"><span class="token sort_Id">annotationList</span></span></span><span class="operator">,</span> <span class="cons_Var"><a href="#name_38_28" id="name_36_44" title="a definition with a single reference"><span class="token sort_Id">name</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#class_37_49" id="class_36_50" title="a definition with a single reference"><span class="token sort_Id">class</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#optParameterInstantiations_39_108" id="optParameterInstantiations_36_57" title="a definition with a single reference"><span class="token sort_Id">optParameterInstantiations</span></a></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="T_37_10" title="a definition with multiple references" data-urls="#T line 37_13, 38_34, 39_74"><span class="token sort_Id">T</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#T_37_10" id="T_37_13" title="a reference to a single-file definition"><span class="token sort_Id">T</span></a></span> <span class="operator">==</span> <a href="../statics-names.stx/#typeOfProcessOrClusterClass_61_5" id="typeOfProcessOrClusterClass_37_18" title="a reference to a single-file definition"><span class="token sort_Id">typeOfProcessOrClusterClass</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_36_16" id="s_37_46" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#class_36_50" id="class_37_49" title="a reference to a single-file definition"><span class="token sort_Id">class</span></a></span><span class="operator">),</span>
        <a href="../statics-names.stx/#declareInstance_258_5" id="declareInstance_38_9" title="a reference to a single-file definition"><span class="token sort_Id">declareInstance</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_36_16" id="s_38_25" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#name_36_44" id="name_38_28" title="a reference to a single-file definition"><span class="token sort_Id">name</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#T_37_10" id="T_38_34" title="a reference to a single-file definition"><span class="token sort_Id">T</span></a></span><span class="operator">),</span>
        <a href="#okInstanceParameters_41_5" id="okInstanceParameters_39_9" title="a reference to a single-file definition"><span class="token sort_Id">okInstanceParameters</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_36_16" id="s_39_30" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <a href="#externalScopeOfTypeProcessOrClusterClass_73_5" id="externalScopeOfTypeProcessOrClusterClass_39_33" title="a reference to a single-file definition"><span class="token sort_Id">externalScopeOfTypeProcessOrClusterClass</span></a><span class="operator">(</span><span class="cons_Var"><a href="#T_37_10" id="T_39_74" title="a reference to a single-file definition"><span class="token sort_Id">T</span></a></span><span class="operator">),</span> <a href="../statics-opt.stx/#stripOptInstanceParameterList_13_5" id="stripOptInstanceParameterList_39_78" title="a reference to a single-file definition"><span class="token sort_Id">stripOptInstanceParameterList</span></a><span class="operator">(</span><span class="cons_Var"><a href="#optParameterInstantiations_36_57" id="optParameterInstantiations_39_108" title="a reference to a single-file definition"><span class="token sort_Id">optParameterInstantiations</span></a></span><span class="operator">)).</span>

    <a href="#okInstanceParameters_39_9" id="okInstanceParameters_41_5" title="a definition with a single reference"><span class="token sort_Id">okInstanceParameters</span></a> <span class="keyword">maps</span> <a href="#okInstanceParameter_42_5" id="okInstanceParameter_41_31" title="a reference to a single-file definition"><span class="token sort_Id">okInstanceParameter</span></a><span class="operator">(*,</span> <span class="operator">*,</span> <span class="keyword">list</span><span class="operator">(*))</span>
    <button class="modal-open" id="okInstanceParameter_42_5" title="a definition with multiple references" data-urls="#okInstanceParameter line 41_31, 43_5"><span class="token sort_Id">okInstanceParameter</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#InstanceParameter_41_5" id="InstanceParameter_42_43" title="a reference to a single-file definition"><span class="token sort_Id">InstanceParameter</span></a></span>
    <a href="#okInstanceParameter_42_5" id="okInstanceParameter_43_5" title="a reference to a single-file definition"><span class="token sort_Id">okInstanceParameter</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_45_41" id="s_43_25" title="a definition with a single reference"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#s_instance_44_41" id="s_instance_43_28" title="a definition with a single reference"><span class="token sort_Id">s_instance</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#InstanceParameter_142_5" id="InstanceParameter_43_40" title="a reference to a single-file definition"><span class="token sort_Id">InstanceParameter</span></a><span class="operator">(</span><span class="cons_Var"><a href="#name_44_53" id="name_43_58" title="a definition with a single reference"><span class="token sort_Id">name</span></a></span><span class="operator">,</span> <span class="cons_Var"><button class="modal-open" id="expr_43_64" title="a definition with multiple references" data-urls="#expr line 45_65, 46_79"><span class="token sort_Id">expr</span></button></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="T_var_44_10" title="a definition with multiple references" data-urls="#T_var line 44_17, 46_30"><span class="token sort_Id">T_var</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#T_var_44_10" id="T_var_44_17" title="a reference to a single-file definition"><span class="token sort_Id">T_var</span></a></span> <span class="operator">==</span> <a href="../statics-names.stx/#typeOfVariable_304_5" id="typeOfVariable_44_26" title="a reference to a single-file definition"><span class="token sort_Id">typeOfVariable</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_instance_43_28" id="s_instance_44_41" title="a reference to a single-file definition"><span class="token sort_Id">s_instance</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#name_43_58" id="name_44_53" title="a reference to a single-file definition"><span class="token sort_Id">name</span></a></span><span class="operator">),</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="T_expr_45_10" title="a definition with multiple references" data-urls="#T_expr line 45_18, 46_37"><span class="token sort_Id">T_expr</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#T_expr_45_10" id="T_expr_45_18" title="a reference to a single-file definition"><span class="token sort_Id">T_expr</span></a></span> <span class="operator">==</span> <a href="../statics-expr-stat.stx/#okExpression_129_5" id="okExpression_45_28" title="a reference to a single-file definition"><span class="token sort_Id">okExpression</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_43_25" id="s_45_41" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../statics-names.stx/#TypeDataClassRoot_20_9" id="TypeDataClassRoot_45_44" title="a reference to a single-file definition"><span class="token sort_Id">TypeDataClassRoot</span></a><span class="operator">()</span></span><span class="operator">,</span> <span class="cons_Var"><a href="#expr_43_64" id="expr_45_65" title="a reference to a single-file definition"><span class="token sort_Id">expr</span></a></span><span class="operator">),</span>
        <span class="keyword">try</span> <span class="operator">{</span> <a href="../statics-typing.stx/#compatibleType_13_5" id="compatibleType_46_15" title="a reference to a single-file definition"><span class="token sort_Id">compatibleType</span></a><span class="operator">(</span><span class="cons_Var"><a href="#T_var_44_10" id="T_var_46_30" title="a reference to a single-file definition"><span class="token sort_Id">T_var</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#T_expr_45_10" id="T_expr_46_37" title="a reference to a single-file definition"><span class="token sort_Id">T_expr</span></a></span><span class="operator">)</span> <span class="operator">}</span> <span class="operator">|</span> <span class="token sort_Id">warning</span> <span class="operator">$[</span><span class="cons_Text">Incompatible type</span><span class="operator">]</span> <span class="operator">@</span><span class="cons_Var"><a href="#expr_43_64" id="expr_46_79" title="a reference to a single-file definition"><span class="token sort_Id">expr</span></a></span><span class="operator">.</span>

    <button class="modal-open" id="okChannels_48_5" title="a definition with multiple references" data-urls="../statics.stx/#okChannels line 64_9, 69_9"><span class="token sort_Id">okChannels</span></button> <span class="keyword">maps</span> <a href="#okChannel_49_5" id="okChannel_48_21" title="a reference to a single-file definition"><span class="token sort_Id">okChannel</span></a><span class="operator">(*,</span> <span class="keyword">list</span><span class="operator">(*))</span>
    <button class="modal-open" id="okChannel_49_5" title="a definition with multiple references" data-urls="#okChannel line 48_21, 50_5"><span class="token sort_Id">okChannel</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#Channel_43_5" id="Channel_49_25" title="a reference to a single-file definition"><span class="token sort_Id">Channel</span></a></span>
    <a href="#okChannel_49_5" id="okChannel_50_5" title="a reference to a single-file definition"><span class="token sort_Id">okChannel</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="s_50_15" title="a definition with multiple references" data-urls="#s line 53_25, 54_26"><span class="token sort_Id">s</span></button></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#Channel_144_5" id="Channel_50_18" title="a reference to a single-file definition"><span class="token sort_Id">Channel</span></a><span class="operator">(</span><span class="cons_Var"><span id="annotationList_50_26" title="a definition with no references"><span class="token sort_Id">annotationList</span></span></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#PortInstanceList_145_5" id="PortInstanceList_50_42" title="a reference to a single-file definition"><span class="token sort_Id">PortInstanceList</span></a><span class="operator">(</span><span class="cons_Var"><button class="modal-open" id="portInstances_50_59" title="a definition with multiple references" data-urls="#portInstances line 51_65, 53_28, 54_29"><span class="token sort_Id">portInstances</span></button></span><span class="operator">)</span></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="count_ext_ports_51_10" title="a definition with multiple references" data-urls="#count_ext_ports line 51_27, 52_25, 54_44"><span class="token sort_Id">count_ext_ports</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#count_ext_ports_51_10" id="count_ext_ports_51_27" title="a reference to a single-file definition"><span class="token sort_Id">count_ext_ports</span></a></span> <span class="operator">==</span> <a href="#countExternalPorts_79_5" id="countExternalPorts_51_46" title="a reference to a single-file definition"><span class="token sort_Id">countExternalPorts</span></a><span class="operator">(</span><span class="cons_Var"><a href="#portInstances_50_59" id="portInstances_51_65" title="a reference to a single-file definition"><span class="token sort_Id">portInstances</span></a></span><span class="operator">),</span>
        <span class="keyword">try</span> <span class="operator">{</span> <a href="#atMostOne_86_5" id="atMostOne_52_15" title="a reference to a single-file definition"><span class="token sort_Id">atMostOne</span></a><span class="operator">(</span><span class="cons_Var"><a href="#count_ext_ports_51_10" id="count_ext_ports_52_25" title="a reference to a single-file definition"><span class="token sort_Id">count_ext_ports</span></a></span><span class="operator">)</span> <span class="operator">}</span> <span class="operator">|</span> <span class="keyword">error</span> <span class="operator">$[</span><span class="cons_Text">There should be at most 1 external port</span><span class="operator">],</span>
        <a href="#okPortInstances_62_5" id="okPortInstances_53_9" title="a reference to a single-file definition"><span class="token sort_Id">okPortInstances</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_50_15" id="s_53_25" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#portInstances_50_59" id="portInstances_53_28" title="a reference to a single-file definition"><span class="token sort_Id">portInstances</span></a></span><span class="operator">),</span>
        <a href="#okChannelClosure_56_5" id="okChannelClosure_54_9" title="a reference to a single-file definition"><span class="token sort_Id">okChannelClosure</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_50_15" id="s_54_26" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#portInstances_50_59" id="portInstances_54_29" title="a reference to a single-file definition"><span class="token sort_Id">portInstances</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#count_ext_ports_51_10" id="count_ext_ports_54_44" title="a reference to a single-file definition"><span class="token sort_Id">count_ext_ports</span></a></span><span class="operator">).</span>

    <button class="modal-open" id="okChannelClosure_56_5" title="a definition with multiple references" data-urls="#okChannelClosure line 54_9, 57_5, 58_5"><span class="token sort_Id">okChannelClosure</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="keyword">list</span><span class="operator">(</span><span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#PortInstance_44_5" id="PortInstance_56_37" title="a reference to a single-file definition"><span class="token sort_Id">PortInstance</span></a></span><span class="operator">)</span> <span class="operator">*</span> <span class="cons_IntSort"><span class="token sort_Id">int</span></span>
    <a href="#okChannelClosure_56_5" id="okChannelClosure_57_5" title="a reference to a single-file definition"><span class="token sort_Id">okChannelClosure</span></a><span class="operator">(</span><span class="cons_Var"><span id="s_57_22" title="a definition with no references"><span class="token sort_Id">s</span></span></span><span class="operator">,</span> <span class="cons_Var"><span id="pis_57_25" title="a definition with no references"><span class="token sort_Id">pis</span></span></span><span class="operator">,</span> 0<span class="operator">).</span>
    <a href="#okChannelClosure_56_5" id="okChannelClosure_58_5" title="a reference to a single-file definition"><span class="token sort_Id">okChannelClosure</span></a><span class="operator">(</span><span class="cons_Var"><span id="s_58_22" title="a definition with no references"><span class="token sort_Id">s</span></span></span><span class="operator">,</span> <span class="cons_Var"><span id="pis_58_25" title="a definition with no references"><span class="token sort_Id">pis</span></span></span><span class="operator">,</span> <span class="operator">_).</span>
        <span class="layout">// TODO check unconnected messages</span>
        <span class="layout">// TODO check type compatibility of messages</span>

    <a href="#okPortInstances_53_9" id="okPortInstances_62_5" title="a definition with a single reference"><span class="token sort_Id">okPortInstances</span></a> <span class="keyword">maps</span> <a href="#okPortInstance_63_5" id="okPortInstance_62_26" title="a reference to a single-file definition"><span class="token sort_Id">okPortInstance</span></a><span class="operator">(*,</span> <span class="keyword">list</span><span class="operator">(*))</span>
    <button class="modal-open" id="okPortInstance_63_5" title="a definition with multiple references" data-urls="#okPortInstance line 62_26, 64_5, 68_5"><span class="token sort_Id">okPortInstance</span></button> <span class="operator">:</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span> <span class="operator">*</span> <span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#PortInstance_44_5" id="PortInstance_63_30" title="a reference to a single-file definition"><span class="token sort_Id">PortInstance</span></a></span>
    <a href="#okPortInstance_63_5" id="okPortInstance_64_5" title="a reference to a single-file definition"><span class="token sort_Id">okPortInstance</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_65_51" id="s_64_20" title="a definition with a single reference"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#InternalPort_146_5" id="InternalPort_64_23" title="a reference to a single-file definition"><span class="token sort_Id">InternalPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#instanceName_65_54" id="instanceName_64_36" title="a definition with a single reference"><span class="token sort_Id">instanceName</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#portName_67_38" id="portName_64_50" title="a definition with a single reference"><span class="token sort_Id">portName</span></a></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="T_instance_65_10" title="a definition with multiple references" data-urls="#T_instance line 65_22, 66_90"><span class="token sort_Id">T_instance</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#T_instance_65_10" id="T_instance_65_22" title="a reference to a single-file definition"><span class="token sort_Id">T_instance</span></a></span> <span class="operator">==</span> <a href="../statics-names.stx/#typeOfInstance_264_5" id="typeOfInstance_65_36" title="a reference to a single-file definition"><span class="token sort_Id">typeOfInstance</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_64_20" id="s_65_51" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#instanceName_64_36" id="instanceName_65_54" title="a reference to a single-file definition"><span class="token sort_Id">instanceName</span></a></span><span class="operator">),</span>
        <span class="operator">{</span><span class="cons_Var"><button class="modal-open" id="T_instance_scope_66_10" title="a definition with multiple references" data-urls="#T_instance_scope line 66_28, 67_20"><span class="token sort_Id">T_instance_scope</span></button></span><span class="operator">}</span> <span class="cons_Var"><a href="#T_instance_scope_66_10" id="T_instance_scope_66_28" title="a reference to a single-file definition"><span class="token sort_Id">T_instance_scope</span></a></span> <span class="operator">==</span>  <a href="#externalScopeOfTypeProcessOrClusterClass_73_5" id="externalScopeOfTypeProcessOrClusterClass_66_49" title="a reference to a single-file definition"><span class="token sort_Id">externalScopeOfTypeProcessOrClusterClass</span></a><span class="operator">(</span><span class="cons_Var"><a href="#T_instance_65_10" id="T_instance_66_90" title="a reference to a single-file definition"><span class="token sort_Id">T_instance</span></a></span><span class="operator">),</span>
        <a href="../statics-names.stx/#typeOfPort_283_5" id="typeOfPort_67_9" title="a reference to a single-file definition"><span class="token sort_Id">typeOfPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#T_instance_scope_66_10" id="T_instance_scope_67_20" title="a reference to a single-file definition"><span class="token sort_Id">T_instance_scope</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#portName_64_50" id="portName_67_38" title="a reference to a single-file definition"><span class="token sort_Id">portName</span></a></span><span class="operator">).</span>
    <a href="#okPortInstance_63_5" id="okPortInstance_68_5" title="a reference to a single-file definition"><span class="token sort_Id">okPortInstance</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_69_20" id="s_68_20" title="a definition with a single reference"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#ExternalPort_147_5" id="ExternalPort_68_23" title="a reference to a single-file definition"><span class="token sort_Id">ExternalPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#portName_69_23" id="portName_68_36" title="a definition with a single reference"><span class="token sort_Id">portName</span></a></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">:-</span>
        <a href="../statics-names.stx/#typeOfPort_283_5" id="typeOfPort_69_9" title="a reference to a single-file definition"><span class="token sort_Id">typeOfPort</span></a><span class="operator">(</span><span class="cons_Var"><a href="#s_68_20" id="s_69_20" title="a reference to a single-file definition"><span class="token sort_Id">s</span></a></span><span class="operator">,</span> <span class="cons_Var"><a href="#portName_68_36" id="portName_69_23" title="a reference to a single-file definition"><span class="token sort_Id">portName</span></a></span><span class="operator">).</span>

<span class="keyword">rules</span>

    <button class="modal-open" id="externalScopeOfTypeProcessOrClusterClass_73_5" title="a definition with multiple references" data-urls="#externalScopeOfTypeProcessOrClusterClass line 39_33, 66_49, 74_5, 75_5"><span class="token sort_Id">externalScopeOfTypeProcessOrClusterClass</span></button> <span class="operator">:</span> <span class="cons_SimpleSort"><a href="../statics-names.stx/#TypeProcessOrClusterClass_14_11" id="TypeProcessOrClusterClass_73_48" title="a reference to a single-file definition"><span class="token sort_Id">TypeProcessOrClusterClass</span></a></span> <span class="operator">-&gt;</span> <span class="cons_ScopeSort"><span class="keyword">scope</span></span>
    <a href="#externalScopeOfTypeProcessOrClusterClass_73_5" id="externalScopeOfTypeProcessOrClusterClass_74_5" title="a reference to a single-file definition"><span class="token sort_Id">externalScopeOfTypeProcessOrClusterClass</span></a><span class="operator">(</span><span class="cons_Op"><a href="../statics-names.stx/#TypeClusterClass_15_9" id="TypeClusterClass_74_46" title="a reference to a single-file definition"><span class="token sort_Id">TypeClusterClass</span></a><span class="operator">(</span><span class="cons_Var"><span id="s_external_74_63" title="a definition with no references"><span class="token sort_Id">s_external</span></span></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">=</span> <span class="cons_Var">s_external</span><span class="operator">.</span>
    <a href="#externalScopeOfTypeProcessOrClusterClass_73_5" id="externalScopeOfTypeProcessOrClusterClass_75_5" title="a reference to a single-file definition"><span class="token sort_Id">externalScopeOfTypeProcessOrClusterClass</span></a><span class="operator">(</span><span class="cons_Op"><a href="../statics-names.stx/#TypeProcessClass_17_9" id="TypeProcessClass_75_46" title="a reference to a single-file definition"><span class="token sort_Id">TypeProcessClass</span></a><span class="operator">(</span><span class="cons_Var"><span id="s_external_75_63" title="a definition with no references"><span class="token sort_Id">s_external</span></span></span><span class="operator">,</span> <span class="cons_Var"><span id="s_internal_75_75" title="a definition with no references"><span class="token sort_Id">s_internal</span></span></span><span class="operator">)</span></span><span class="operator">)</span> <span class="operator">=</span> <span class="cons_Var">s_external</span><span class="operator">.</span>

<span class="keyword">rules</span>

    <button class="modal-open" id="countExternalPorts_79_5" title="a definition with multiple references" data-urls="#countExternalPorts line 51_46, 80_5, 81_5, 82_18, 84_5, 84_34"><span class="token sort_Id">countExternalPorts</span></button> <span class="operator">:</span> <span class="keyword">list</span><span class="operator">(</span><span class="cons_SimpleSort"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#PortInstance_44_5" id="PortInstance_79_31" title="a reference to a single-file definition"><span class="token sort_Id">PortInstance</span></a></span><span class="operator">)</span> <span class="operator">-&gt;</span> <span class="cons_IntSort"><span class="token sort_Id">int</span></span>
    <a href="#countExternalPorts_79_5" id="countExternalPorts_80_5" title="a reference to a single-file definition"><span class="token sort_Id">countExternalPorts</span></a><span class="operator">([])</span> <span class="operator">=</span> 0<span class="operator">.</span>
    <a href="#countExternalPorts_79_5" id="countExternalPorts_81_5" title="a reference to a single-file definition"><span class="token sort_Id">countExternalPorts</span></a><span class="operator">([</span><span class="cons_Op"><a href="../../src-gen/statix/signatures/Poosl-sig.stx/#ExternalPort_147_5" id="ExternalPort_81_25" title="a reference to a single-file definition"><span class="token sort_Id">ExternalPort</span></a><span class="operator">(_)</span></span><span class="operator">|</span><span class="cons_Var"><a href="#Cs_82_37" id="Cs_81_41" title="a definition with a single reference"><span class="token sort_Id">Cs</span></a></span><span class="operator">])</span> <span class="operator">=</span> <span class="cons_Var"><a href="#len_83_9" id="len_81_48" title="a definition with a single reference"><span class="token sort_Id">len</span></a></span> <span class="operator">:-</span> <span class="operator">{</span><span class="cons_Var"><a href="#t_len_82_9" id="t_len_81_56" title="a definition with a single reference"><span class="token sort_Id">t_len</span></a></span><span class="operator">}</span>
        <span class="cons_Var"><a href="#t_len_81_56" id="t_len_82_9" title="a reference to a single-file definition"><span class="token sort_Id">t_len</span></a></span> <span class="operator">==</span> <a href="#countExternalPorts_79_5" id="countExternalPorts_82_18" title="a reference to a single-file definition"><span class="token sort_Id">countExternalPorts</span></a><span class="operator">(</span><span class="cons_Var"><a href="#Cs_81_41" id="Cs_82_37" title="a reference to a single-file definition"><span class="token sort_Id">Cs</span></a></span><span class="operator">),</span>
        <span class="cons_Var"><a href="#len_81_48" id="len_83_9" title="a reference to a single-file definition"><span class="token sort_Id">len</span></a></span> <span class="operator">#=</span> <span class="cons_Var">t_len</span> <span class="operator">+</span> 1<span class="operator">.</span>
    <a href="#countExternalPorts_79_5" id="countExternalPorts_84_5" title="a reference to a single-file definition"><span class="token sort_Id">countExternalPorts</span></a><span class="operator">([_|</span><span class="cons_Var"><span id="Cs_84_27" title="a definition with no references"><span class="token sort_Id">Cs</span></span></span><span class="operator">])</span> <span class="operator">=</span> <a href="#countExternalPorts_79_5" id="countExternalPorts_84_34" title="a reference to a single-file definition"><span class="token sort_Id">countExternalPorts</span></a><span class="operator">(</span><span class="cons_Var">Cs</span><span class="operator">).</span>
    
    <button class="modal-open" id="atMostOne_86_5" title="a definition with multiple references" data-urls="#atMostOne line 52_15, 87_5, 88_5"><span class="token sort_Id">atMostOne</span></button> <span class="operator">:</span> <span class="cons_IntSort"><span class="token sort_Id">int</span></span>
    <a href="#atMostOne_86_5" id="atMostOne_87_5" title="a reference to a single-file definition"><span class="token sort_Id">atMostOne</span></a><span class="operator">(</span>0<span class="operator">).</span>
    <a href="#atMostOne_86_5" id="atMostOne_88_5" title="a reference to a single-file definition"><span class="token sort_Id">atMostOne</span></a><span class="operator">(</span>1<span class="operator">).</span>

</code></pre></td></tr></tbody></table></div>

<div id="modal">
  <div id="modal-content">
    <span id="modal-close">&times;</span>
    <h2 id="modal-h2"></h2>
    <p  id="modal-p"></p>
    <ul id="modal-ul"></ul>
  </div>
</div>
